define("Skwitch/Animation/Animation",["./Sequence","objects/extend","Seed/Seed","objects/is","Array/eachPair"],function(e,t,n,r,i){var s=e.extend({"+options":{parentAnimation:null,start:0,end:430,security:400,parentEl:null,domDesc:null,keyInstant:null},"+init":function(){},"+doBuild":function(e){this.setParentEl(),this.setTimeline(),this.initEventsTimeline(),this.buildSequences(),e&&e.state&&this.fire("tick",e.state-this.timeline.start-this.start),delete this.unformattedSequencesInit,delete this.sequencesInit},setParentEl:function(){this.parentEl=this.parentEl||this._a.el},setTimeline:function(){this.parentAnimation?this.timeline=this.parentAnimation:this.timeline=this._a.timeline},initEventsTimeline:function(){this.appState=this.timeline.appState-this.start,this.timeline.on("tick",function(e){this.appState=e-this.start,this.beforeTick&&this.beforeTick(e-this.start),this.fire("tick",e-this.start),this.afterTick&&this.afterTick(e-this.start)}.bind(this),this)},between:function(e,t,n){n=this.formatBetweenOption(n),this.on("tick",function(r){var i=r>=e&&r<=t,s=n._running;i?(s||n.enter&&n.enter(r-e),n._running=!0,n.during&&n.during.call(self,(r-e)/(t-e))):s&&(n.out&&n.out(),n._running=!1)}.bind(this),this)},buildBetweens:function(e){e.frames.eachPair(function(t,n,r){this.buildBetween(t,n,r,e)}.bind(this))},buildBetween:function(e,t,n,r){var i=[e.instant,t.instant];n===0&&this.buildBetweenToBeginning(i,r),n===r.frames.length-2&&this.buildBetweenToEnd(i,r),this.buildBetweenDuring(i,r,n)},buildBetweenDuring:function(e,t,n){var r={during:function(e){t.render({between:[n,n+1],r:e})}.bind(this)};this.between(e[0],e[1],r)},buildBetweenToBeginning:function(e,t){var n=-t.security||-this.security||-20;this.between(n,e[0],function(){t.renderFrame(0)})},buildBetweenToEnd:function(e,t){var n=t.security||this.security||e[1]+20;this.between(e[1],n,function(e){t.renderFrameEnd()})},formatBetweenOption:function(e){var t,n;return r("function",e)?(n=e,t={during:n}):t=e,t},buildSequences:function(){this.sequencesInit&&!this.unformattedSequencesInit&&(this.unformattedSequencesInit=this.sequencesInit,this.sequencesInit=null),!this.unformattedSequencesInit&&this.buildSequencesInit&&(this.unformattedSequencesInit=this.buildSequencesInit()),this.unformattedSequencesInit||(this.unformattedSequencesInit=[]),this.sequences=[],this.sequencesInit=this.formatSequencesInit(this.unformattedSequencesInit),this.sequencesInit.each(function(e){e.render!==!1&&this.sequences.push(this.buildSequence(e))}.bind(this))},formatSequencesInit:function(e){var t;return r("function",e)?t=e.call(this):t=e,t},buildSequence:function(e){this.sequence={},e=this.formatSequenceInit(e);var t=this.sub(e.cstr,e);return this.sequence[t.name]=t,this.buildBetweens(t),t},formatSequenceInit:function(n){var r={};r=t({parentEl:n.parentEl||this.el||this.parentEl,render:!0,cstr:e,keyInstant:this.formatKeyInstant(this.keyInstant)},n);if(r.type){var i="format"+r.type.capitalize()+"Type";this[i]&&(formated=this[i](r))}return r},formatImgType:function(e){var t=e.extension||"png",n=e.src||"/assets/"+this.name+"/"+e.name+"."+t,r;return e.domDesc={tag:"img",style:{zIndex:e.zIndex||""},attr:{src:n,"class":"sequence"}},r=e,r},formatAnimationType:function(e){var t=e;return t.start=e.start||this.start,t.end=e.end||this.end,t.parentAnimation=this,t},formatKeyInstant:function(e){var t=this.keyInstant||{};return t.start=r("number",this.start)&&this.start||0,t.end=this.end||430,t},isAnimation:!0,destroy:function(){this._isBuilt&&(n.prototype.destroy.call(this),this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.sequences&&this.sequences.send("destroy"),this._isBuilt=!1)}});return s});